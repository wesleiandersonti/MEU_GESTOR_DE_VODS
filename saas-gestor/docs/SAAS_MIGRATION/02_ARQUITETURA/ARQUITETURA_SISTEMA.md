# ğŸ—ï¸ ARQUITETURA DO SISTEMA SaaS

## 1. VisÃ£o Geral da Arquitetura

### 1.1 Diagrama de Alto NÃ­vel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENTES                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Web App â”‚  â”‚ Mobile   â”‚  â”‚ Desktop  â”‚  â”‚  API     â”‚       â”‚
â”‚  â”‚ (React)  â”‚  â”‚ (Futuro) â”‚  â”‚ (Atual)  â”‚  â”‚ (REST)   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         CLOUDFLARE (CDN/WAF)             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         LOAD BALANCER (AWS ALB)         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         KUBERNETES CLUSTER              â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
        â”‚  â”‚   Web Pods  â”‚    â”‚   API Pods  â”‚     â”‚
        â”‚  â”‚  (React)    â”‚    â”‚  (.NET 8)   â”‚     â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚
        â”‚                            â”‚            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
        â”‚  â”‚ Worker Pods â”‚    â”‚  Cache      â”‚     â”‚
        â”‚  â”‚ (Hangfire)  â”‚    â”‚  (Redis)    â”‚     â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
   â”‚PostgreSQLâ”‚        â”‚    S3       â”‚      â”‚  RabbitMQ  â”‚
   â”‚ (Dados) â”‚        â”‚  (Arquivos) â”‚      â”‚   (Fila)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Componentes Principais

| Componente | Tecnologia | PropÃ³sito |
|------------|------------|-----------|
| **Frontend** | React + TypeScript | Interface do usuÃ¡rio |
| **Backend API** | ASP.NET Core 8 | API RESTful |
| **Banco de Dados** | PostgreSQL 15 | Dados persistentes |
| **Cache** | Redis | Performance e sessÃµes |
| **Fila** | RabbitMQ / Hangfire | Processamento assÃ­ncrono |
| **Storage** | AWS S3 | Arquivos e backups |
| **CDN** | CloudFlare | Performance global |
| **Auth** | IdentityServer / Auth0 | AutenticaÃ§Ã£o |

---

## 2. Arquitetura Multi-Tenant

### 2.1 EstratÃ©gia: Banco Compartilhado com Tenant ID

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BANCO POSTGRESQL                  â”‚
â”‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Tenant A    â”‚  â”‚  Tenant B    â”‚           â”‚
â”‚  â”‚  User: 001   â”‚  â”‚  User: 002   â”‚           â”‚
â”‚  â”‚  Data: [...] â”‚  â”‚  Data: [...] â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                â”‚
â”‚  TODAS as tabelas tÃªm campo: tenant_id        â”‚
â”‚  Query automaticamente filtra por tenant      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Vantagens:**
- âœ… Custo mais baixo
- âœ… Backup Ãºnico
- âœ… MigraÃ§Ã£o simples
- âœ… Escalabilidade horizontal

**Desvantagens:**
- âš ï¸ Complexidade nas queries
- âš ï¸ Risco de vazamento de dados (mitigado com filtros)

### 2.2 Isolamento de Dados

```csharp
// Exemplo de filtro automÃ¡tico no Entity Framework
public class TenantDbContext : DbContext
{
    private readonly string _tenantId;
    
    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        // Aplica filtro global em todas as entidades
        modelBuilder.Entity<Playlist>().HasQueryFilter(p => p.TenantId == _tenantId);
        modelBuilder.Entity<Channel>().HasQueryFilter(c => c.TenantId == _tenantId);
        // ... etc
    }
}
```

---

## 3. Estrutura de MicroserviÃ§os (Opcional)

### 3.1 VersÃ£o Monolito Modular (Recomendado para MVP)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API GATEWAY                 â”‚
â”‚      (YARP / Ocelot)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API PRINCIPAL               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Auth    â”‚ â”‚Playlists â”‚         â”‚
â”‚  â”‚  Module  â”‚ â”‚  Module  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Checker  â”‚ â”‚  Player  â”‚         â”‚
â”‚  â”‚  Module  â”‚ â”‚  Module  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 VersÃ£o MicroserviÃ§os (Futuro)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API GATEWAY                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”
â”‚Auth   â”‚ â”‚Playlistâ”‚ â”‚Checkerâ”‚
â”‚Serviceâ”‚ â”‚Service â”‚ â”‚Serviceâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚          â”‚          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚  DATABASE   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Modelo de Dados (ERD)

### 4.1 Diagrama Entidade-Relacionamento

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    tenants      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ name            â”‚
â”‚ plan_id         â”‚
â”‚ created_at      â”‚
â”‚ status          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚       â”‚     plans       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚       â”‚ id (PK)         â”‚
â”‚ tenant_id (FK)  â”‚â—„â”€â”€â”€â”€â”€â”€â”‚ name            â”‚
â”‚ email           â”‚       â”‚ max_playlists   â”‚
â”‚ password_hash   â”‚       â”‚ max_storage     â”‚
â”‚ role            â”‚       â”‚ price           â”‚
â”‚ created_at      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   playlists     â”‚       â”‚   categories    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚       â”‚ id (PK)         â”‚
â”‚ tenant_id (FK)  â”‚       â”‚ tenant_id (FK)  â”‚
â”‚ user_id (FK)    â”‚       â”‚ name            â”‚
â”‚ name            â”‚       â”‚ parent_id       â”‚
â”‚ url             â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ content         â”‚
â”‚ last_check      â”‚
â”‚ status          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    channels     â”‚       â”‚  check_results  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚       â”‚ id (PK)         â”‚
â”‚ playlist_id(FK) â”‚       â”‚ channel_id (FK) â”‚
â”‚ name            â”‚       â”‚ status          â”‚
â”‚ url             â”‚       â”‚ response_time   â”‚
â”‚ logo_url        â”‚       â”‚ checked_at      â”‚
â”‚ group_title     â”‚       â”‚ error_msg       â”‚
â”‚ is_favorite     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Tabelas Principais

#### tenants
```sql
CREATE TABLE tenants (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,
    plan_id UUID REFERENCES plans(id),
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### users
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID NOT NULL REFERENCES tenants(id),
    email VARCHAR(255) NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(255),
    role VARCHAR(50) DEFAULT 'user',
    email_verified BOOLEAN DEFAULT FALSE,
    last_login TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(tenant_id, email)
);
```

#### playlists
```sql
CREATE TABLE playlists (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID NOT NULL REFERENCES tenants(id),
    user_id UUID NOT NULL REFERENCES users(id),
    name VARCHAR(255) NOT NULL,
    url TEXT,
    content TEXT,
    format VARCHAR(20) DEFAULT 'm3u',
    channel_count INTEGER DEFAULT 0,
    last_check TIMESTAMP,
    status VARCHAR(20) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 5. API RESTful

### 5.1 Endpoints Principais

```
Base URL: https://api.meugestorvods.com/v1

AUTHENTICATION
â”œâ”€â”€ POST   /auth/register
â”œâ”€â”€ POST   /auth/login
â”œâ”€â”€ POST   /auth/refresh
â”œâ”€â”€ POST   /auth/forgot-password
â””â”€â”€ POST   /auth/reset-password

PLAYLISTS
â”œâ”€â”€ GET    /playlists
â”œâ”€â”€ POST   /playlists
â”œâ”€â”€ GET    /playlists/{id}
â”œâ”€â”€ PUT    /playlists/{id}
â”œâ”€â”€ DELETE /playlists/{id}
â”œâ”€â”€ POST   /playlists/{id}/import
â””â”€â”€ POST   /playlists/{id}/check

CHANNELS
â”œâ”€â”€ GET    /channels
â”œâ”€â”€ GET    /channels/{id}
â”œâ”€â”€ PUT    /channels/{id}
â”œâ”€â”€ POST   /channels/{id}/favorite
â””â”€â”€ POST   /channels/{id}/check

CHECKER
â”œâ”€â”€ POST   /checker/run
â”œâ”€â”€ GET    /checker/status/{jobId}
â”œâ”€â”€ GET    /checker/results
â””â”€â”€ GET    /checker/servers

USER
â”œâ”€â”€ GET    /user/profile
â”œâ”€â”€ PUT    /user/profile
â”œâ”€â”€ GET    /user/stats
â””â”€â”€ DELETE /user/account
```

### 5.2 Exemplo de Request/Response

```http
POST /api/v1/playlists
Authorization: Bearer <token>
Content-Type: application/json

{
  "name": "Minha Playlist",
  "url": "https://exemplo.com/lista.m3u",
  "autoUpdate": true
}
```

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "name": "Minha Playlist",
  "url": "https://exemplo.com/lista.m3u",
  "status": "processing",
  "channelCount": 0,
  "createdAt": "2026-02-10T15:30:00Z",
  "updatedAt": "2026-02-10T15:30:00Z"
}
```

---

## 6. SeguranÃ§a

### 6.1 AutenticaÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FLUXO DE LOGIN                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  1. User POST /auth/login               â”‚
â”‚     { email, password }                 â”‚
â”‚                                          â”‚
â”‚  2. Server valida credenciais           â”‚
â”‚                                          â”‚
â”‚  3. Gera JWT Token:                     â”‚
â”‚     {                                   â”‚
â”‚       "sub": "user_id",                 â”‚
â”‚       "tenant": "tenant_id",            â”‚
â”‚       "role": "user",                   â”‚
â”‚       "exp": 1644518400                 â”‚
â”‚     }                                   â”‚
â”‚                                          â”‚
â”‚  4. Retorna: { access_token, refresh }  â”‚
â”‚                                          â”‚
â”‚  5. Client envia token em todo request  â”‚
â”‚     Authorization: Bearer <token>       â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 AutorizaÃ§Ã£o (RBAC)

```csharp
// Roles definidas
public enum UserRole
{
    Admin,      // Acesso total
    Manager,    // GestÃ£o de playlists
    User,       // Uso bÃ¡sico
    Viewer      // Apenas visualizaÃ§Ã£o
}

// Exemplo de policy
[Authorize(Roles = "Admin,Manager")]
[HttpPost("playlists")]
public async Task<IActionResult> CreatePlaylist(...)
```

---

## 7. Infraestrutura Cloud

### 7.1 AWS (OpÃ§Ã£o 1)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS                      â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           VPC                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚       Public Subnet             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   ALB   â”‚    â”‚   NAT   â”‚     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚       Private Subnet            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   EKS   â”‚    â”‚  RDS    â”‚     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ (K8s)   â”‚    â”‚ (Postg) â”‚     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  ElastiCacheâ”‚â”‚   S3    â”‚     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  (Redis)    â”‚â”‚ (Files) â”‚     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Route 53 â”‚  â”‚CloudFrontâ”‚  â”‚  ACM    â”‚    â”‚
â”‚  â”‚  (DNS)  â”‚  â”‚  (CDN)   â”‚  â”‚ (SSL)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Azure (OpÃ§Ã£o 2)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AZURE                     â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚       Azure Kubernetes Service        â”‚ â”‚
â”‚  â”‚            (AKS)                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Azure Databaseâ”‚  â”‚   Azure Cache    â”‚    â”‚
â”‚  â”‚  for PostgreSQLâ”‚ â”‚   for Redis      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Blob Storageâ”‚  â”‚  Application     â”‚    â”‚
â”‚  â”‚              â”‚  â”‚  Gateway         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Azure Active  â”‚  â”‚   Azure DevOps   â”‚    â”‚
â”‚  â”‚  Directory   â”‚  â”‚   (CI/CD)        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Custos Estimados

### 8.1 Infraestrutura (Mensal)

| ServiÃ§o | Provider | Custo Mensal |
|---------|----------|--------------|
| Kubernetes (3 nodes) | AWS EKS | $150-200 |
| PostgreSQL (db.t3.medium) | AWS RDS | $50-80 |
| Redis (cache.t3.micro) | AWS ElastiCache | $15-25 |
| S3 (100GB) | AWS S3 | $5-10 |
| Load Balancer | AWS ALB | $20-30 |
| CDN | CloudFlare | $0-20 |
| **Total** | | **~$250-400/mÃªs** |

### 8.2 Custo por UsuÃ¡rio

| MÃ©trica | Valor |
|---------|-------|
| Custo fixo mensal | $300 |
| UsuÃ¡rios para break-even | 60 usuÃ¡rios (plano Pro) |
| Margem lÃ­quida estimada | 60-70% |

---

## 9. PrÃ³ximos Passos

### Fase 1: Setup Inicial (Semana 1)
- [ ] Criar conta AWS/Azure
- [ ] Configurar Kubernetes
- [ ] Setup CI/CD
- [ ] Criar repositÃ³rios

### Fase 2: Desenvolvimento (Semanas 2-10)
- [ ] Backend API
- [ ] Frontend React
- [ ] Banco de dados
- [ ] AutenticaÃ§Ã£o

### Fase 3: IntegraÃ§Ã£o (Semanas 11-12)
- [ ] Conectar frontend + backend
- [ ] Testes de integraÃ§Ã£o
- [ ] Performance tuning

---

**PrÃ³ximo documento:** `03_BACKEND_API/API_SPECIFICATION.md`
